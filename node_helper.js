'use strict';

var NodeHelper = require('node_helper');
var gpiox = require('@iiot2k/gpiox');

function _interopNamespaceDefault(e) {
    var n = Object.create(null);
    if (e) {
        Object.keys(e).forEach(function (k) {
            if (k !== 'default') {
                var d = Object.getOwnPropertyDescriptor(e, k);
                Object.defineProperty(n, k, d.get ? d : {
                    enumerable: true,
                    get: function () { return e[k]; }
                });
            }
        });
    }
    n.default = e;
    return Object.freeze(n);
}

var NodeHelper__namespace = /*#__PURE__*/_interopNamespaceDefault(NodeHelper);

class Button {
    constructor(pin) {
        this.eventList = {};
        this.state = {
            active: false,
            lastChange: 0
        };
        this.PIN = pin;
        this._registerListener();
    }
    cleanup() {
        gpiox.deinit_gpio(this.PIN);
    }
    _appendEvent(eventType, callback) {
        this.eventList[eventType] = this.eventList[eventType] || [];
        this.eventList[eventType].push(callback);
    }
    _triggerEvent(eventType) {
        if (!this.eventList[eventType] || this.eventList[eventType].length === 0)
            return;
        this.eventList[eventType].forEach((eventCallback) => {
            eventCallback();
        });
    }
    _registerListener() {
        gpiox.watch_gpio(this.PIN, gpiox.GPIO_MODE_INPUT_PULLUP, 0, gpiox.GPIO_EDGE_BOTH, (btnState) => {
            const now = Date.now();
            if (!btnState) {
                this._triggerEvent("press");
                if (now - this.state.lastChange > 600)
                    this._triggerEvent("longPress");
                else
                    this._triggerEvent("shortPress");
            }
            this.state = {
                active: Boolean(btnState),
                lastChange: now
            };
        });
    }
    onPress(callback) {
        this._appendEvent("press", callback);
    }
    onShortPress(callback) {
        this._appendEvent("shortPress", callback);
    }
    onLongPress(callback) {
        this._appendEvent("longPress", callback);
    }
}

class Rotary {
    constructor({ SW, CLK, DT }) {
        this.eventList = {};
        this.pins = {
            SW,
            CLK,
            DT
        };
        gpiox.init_gpio(DT, 0, 100);
        this.button = new Button(SW);
        this._registerListener();
    }
    cleanup() {
        gpiox.deinit_gpio(this.pins.CLK);
        gpiox.deinit_gpio(this.pins.DT);
        this.button.cleanup();
    }
    _appendEvent(eventType, callback) {
        this.eventList[eventType] = this.eventList[eventType] || [];
        this.eventList[eventType].push(callback);
    }
    _triggerEvent(eventType, event) {
        if (!this.eventList[eventType] || this.eventList[eventType].length === 0)
            return;
        this.eventList[eventType].forEach((eventCallback) => {
            eventCallback(event);
        });
    }
    _registerListener() {
        gpiox.watch_gpio(this.pins.CLK, gpiox.GPIO_MODE_INPUT_PULLUP, 400, gpiox.GPIO_EDGE_BOTH, (state) => {
            if (state === 1) {
                const dtValue = gpiox.get_gpio(this.pins.DT);
                const direction = dtValue ? "left" : "right";
                this._triggerEvent("turn", { direction });
                this._triggerEvent(direction === "left" ? "turnLeft" : "turnRight");
            }
        });
        this.button.onPress(() => {
            this._triggerEvent("press");
        });
        this.button.onShortPress(() => {
            this._triggerEvent("shortPress");
        });
        this.button.onLongPress(() => {
            this._triggerEvent("longPress");
        });
    }
    onTurn(callback) {
        this._appendEvent("turn", callback);
    }
    onTurnLeft(callback) {
        this._appendEvent("turnLeft", callback);
    }
    onTurnRight(callback) {
        this._appendEvent("turnRight", callback);
    }
    onPress(callback) {
        this._appendEvent("press", callback);
    }
    onShortPress(callback) {
        this._appendEvent("shortPress", callback);
    }
    onLongPress(callback) {
        this._appendEvent("longPress", callback);
    }
}

class RotaryNodeHelper {
    constructor(nodeHelper, rotaryPins) {
        this.rotary = null;
        this.nodeHelper = nodeHelper;
        this.rotaryPins = rotaryPins;
    }
    socketNotificationReceived(notification) {
        if (notification === "ROTARY_INIT")
            this._init();
    }
    _init() {
        if (this.rotary)
            return;
        this.rotary = new Rotary(this.rotaryPins);
        this.rotary.onTurnLeft(() => {
            this.nodeHelper.sendSocketNotification("ROTARY_PREV", null);
        });
        this.rotary.onTurnRight(() => {
            this.nodeHelper.sendSocketNotification("ROTARY_NEXT", null);
        });
        this.rotary.onPress(() => {
            this.nodeHelper.sendSocketNotification("ROTARY_PRESS", null);
        });
        this.rotary.onShortPress(() => {
            this.nodeHelper.sendSocketNotification("ROTARY_SHORT_PRESS", null);
        });
        this.rotary.onLongPress(() => {
            this.nodeHelper.sendSocketNotification("ROTARY_LONG_PRESS", null);
        });
    }
}

var Helper = NodeHelper__namespace.create({
    rotaryHelper: RotaryNodeHelper,
    start() {
        console.log("NodeHelper started Rotary Started");
        this.rotaryHelper = new RotaryNodeHelper(this, {
            SW: 27,
            CLK: 17,
            DT: 18
        });
    },
    async socketNotificationReceived(notification, payload) {
        console.log("Rotary start notification recived", notification);
        this.rotaryHelper.socketNotificationReceived(notification);
    }
});

module.exports = Helper;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9oZWxwZXIuanMiLCJzb3VyY2VzIjpbInNyYy9ub2RlL2dwaW8vQnV0dG9uLnRzIiwic3JjL25vZGUvZ3Bpby9Sb3RhcnkudHMiLCJzcmMvbm9kZS9Sb3RhcnlOb2RlSGVscGVyLnRzIiwic3JjL25vZGUvSGVscGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGRlaW5pdF9ncGlvLFxuICBHUElPX0VER0VfQk9USCxcbiAgR1BJT19NT0RFX0lOUFVUX1BVTExVUCxcbiAgd2F0Y2hfZ3Bpb1xufSBmcm9tIFwiQGlpb3Qyay9ncGlveFwiO1xuXG5leHBvcnQgdHlwZSBCdXR0b25FdmVudCA9IFwicHJlc3NcIiB8IFwic2hvcnRQcmVzc1wiIHwgXCJsb25nUHJlc3NcIjtcbmV4cG9ydCB0eXBlIEJ1dHRvbkV2ZW50Q2FsbGJhY2sgPSAoKSA9PiB2b2lkO1xuXG5leHBvcnQgY2xhc3MgQnV0dG9uIHtcbiAgUElOOiBudW1iZXI7XG4gIGV2ZW50TGlzdDogUGFydGlhbDxSZWNvcmQ8QnV0dG9uRXZlbnQsIEJ1dHRvbkV2ZW50Q2FsbGJhY2tbXT4+ID0ge307XG4gIHN0YXRlID0ge1xuICAgIGFjdGl2ZTogZmFsc2UsXG4gICAgbGFzdENoYW5nZTogMFxuICB9O1xuICBjb25zdHJ1Y3RvcihwaW46IG51bWJlcikge1xuICAgIHRoaXMuUElOID0gcGluO1xuXG4gICAgdGhpcy5fcmVnaXN0ZXJMaXN0ZW5lcigpO1xuICB9XG5cbiAgY2xlYW51cCgpIHtcbiAgICBkZWluaXRfZ3Bpbyh0aGlzLlBJTik7XG4gIH1cblxuICBfYXBwZW5kRXZlbnQoZXZlbnRUeXBlOiBCdXR0b25FdmVudCwgY2FsbGJhY2s6IEJ1dHRvbkV2ZW50Q2FsbGJhY2spIHtcbiAgICB0aGlzLmV2ZW50TGlzdFtldmVudFR5cGVdID0gdGhpcy5ldmVudExpc3RbZXZlbnRUeXBlXSB8fCBbXTtcblxuICAgIHRoaXMuZXZlbnRMaXN0W2V2ZW50VHlwZV0ucHVzaChjYWxsYmFjayk7XG4gIH1cbiAgX3RyaWdnZXJFdmVudChldmVudFR5cGU6IEJ1dHRvbkV2ZW50KSB7XG4gICAgaWYgKCF0aGlzLmV2ZW50TGlzdFtldmVudFR5cGVdIHx8IHRoaXMuZXZlbnRMaXN0W2V2ZW50VHlwZV0ubGVuZ3RoID09PSAwKVxuICAgICAgcmV0dXJuO1xuXG4gICAgdGhpcy5ldmVudExpc3RbZXZlbnRUeXBlXS5mb3JFYWNoKChldmVudENhbGxiYWNrKSA9PiB7XG4gICAgICBldmVudENhbGxiYWNrKCk7XG4gICAgfSk7XG4gIH1cblxuICBfcmVnaXN0ZXJMaXN0ZW5lcigpIHtcbiAgICB3YXRjaF9ncGlvKFxuICAgICAgdGhpcy5QSU4sXG4gICAgICBHUElPX01PREVfSU5QVVRfUFVMTFVQLFxuICAgICAgMCxcbiAgICAgIEdQSU9fRURHRV9CT1RILFxuICAgICAgKGJ0blN0YXRlOiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgaWYgKCFidG5TdGF0ZSkge1xuICAgICAgICAgIHRoaXMuX3RyaWdnZXJFdmVudChcInByZXNzXCIpO1xuXG4gICAgICAgICAgaWYgKG5vdyAtIHRoaXMuc3RhdGUubGFzdENoYW5nZSA+IDYwMClcbiAgICAgICAgICAgIHRoaXMuX3RyaWdnZXJFdmVudChcImxvbmdQcmVzc1wiKTtcbiAgICAgICAgICBlbHNlIHRoaXMuX3RyaWdnZXJFdmVudChcInNob3J0UHJlc3NcIik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgIGFjdGl2ZTogQm9vbGVhbihidG5TdGF0ZSksXG4gICAgICAgICAgbGFzdENoYW5nZTogbm93XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIG9uUHJlc3MoY2FsbGJhY2s6IEJ1dHRvbkV2ZW50Q2FsbGJhY2spIHtcbiAgICB0aGlzLl9hcHBlbmRFdmVudChcInByZXNzXCIsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIG9uU2hvcnRQcmVzcyhjYWxsYmFjazogQnV0dG9uRXZlbnRDYWxsYmFjaykge1xuICAgIHRoaXMuX2FwcGVuZEV2ZW50KFwic2hvcnRQcmVzc1wiLCBjYWxsYmFjayk7XG4gIH1cblxuICBvbkxvbmdQcmVzcyhjYWxsYmFjazogQnV0dG9uRXZlbnRDYWxsYmFjaykge1xuICAgIHRoaXMuX2FwcGVuZEV2ZW50KFwibG9uZ1ByZXNzXCIsIGNhbGxiYWNrKTtcbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgZGVpbml0X2dwaW8sXG4gIGdldF9ncGlvLFxuICBHUElPX0VER0VfQk9USCxcbiAgR1BJT19NT0RFX0lOUFVUX1BVTExVUCxcbiAgaW5pdF9ncGlvLFxuICB3YXRjaF9ncGlvXG59IGZyb20gXCJAaWlvdDJrL2dwaW94XCI7XG5pbXBvcnQgeyBCdXR0b24sIEJ1dHRvbkV2ZW50Q2FsbGJhY2sgfSBmcm9tIFwiLi9CdXR0b24uanNcIjtcblxuZXhwb3J0IHR5cGUgUm90YXJ5UGlucyA9IHtcbiAgU1c6IG51bWJlcjtcbiAgQ0xLOiBudW1iZXI7XG4gIERUOiBudW1iZXI7XG59O1xuXG5leHBvcnQgdHlwZSBSb3RhcnlFdmVudCA9XG4gIHwgXCJwcmVzc1wiXG4gIHwgXCJsb25nUHJlc3NcIlxuICB8IFwic2hvcnRQcmVzc1wiXG4gIHwgXCJ0dXJuXCJcbiAgfCBcInR1cm5MZWZ0XCJcbiAgfCBcInR1cm5SaWdodFwiO1xuZXhwb3J0IHR5cGUgUm90YXJ5RXZlbnRDYWxsYmFjayA9IEJ1dHRvbkV2ZW50Q2FsbGJhY2sgfCAoKGU6IGFueSkgPT4gdm9pZCk7XG5cbmV4cG9ydCBjbGFzcyBSb3Rhcnkge1xuICBwaW5zO1xuICBidXR0b247XG4gIGV2ZW50TGlzdDogUGFydGlhbDxSZWNvcmQ8Um90YXJ5RXZlbnQsIFJvdGFyeUV2ZW50Q2FsbGJhY2tbXT4+ID0ge307XG4gIGNvbnN0cnVjdG9yKHsgU1csIENMSywgRFQgfTogUm90YXJ5UGlucykge1xuICAgIHRoaXMucGlucyA9IHtcbiAgICAgIFNXLFxuICAgICAgQ0xLLFxuICAgICAgRFRcbiAgICB9O1xuXG4gICAgaW5pdF9ncGlvKERULCAwIGFzIGFueSwgMTAwKTtcbiAgICB0aGlzLmJ1dHRvbiA9IG5ldyBCdXR0b24oU1cpO1xuICAgIHRoaXMuX3JlZ2lzdGVyTGlzdGVuZXIoKTtcbiAgfVxuXG4gIGNsZWFudXAoKSB7XG4gICAgZGVpbml0X2dwaW8odGhpcy5waW5zLkNMSyk7XG4gICAgZGVpbml0X2dwaW8odGhpcy5waW5zLkRUKTtcbiAgICB0aGlzLmJ1dHRvbi5jbGVhbnVwKCk7XG4gIH1cblxuICBfYXBwZW5kRXZlbnQoZXZlbnRUeXBlOiBSb3RhcnlFdmVudCwgY2FsbGJhY2s6IFJvdGFyeUV2ZW50Q2FsbGJhY2spIHtcbiAgICB0aGlzLmV2ZW50TGlzdFtldmVudFR5cGVdID0gdGhpcy5ldmVudExpc3RbZXZlbnRUeXBlXSB8fCBbXTtcblxuICAgIHRoaXMuZXZlbnRMaXN0W2V2ZW50VHlwZV0ucHVzaChjYWxsYmFjayk7XG4gIH1cbiAgX3RyaWdnZXJFdmVudChldmVudFR5cGU6IFJvdGFyeUV2ZW50LCBldmVudD86IGFueSkge1xuICAgIGlmICghdGhpcy5ldmVudExpc3RbZXZlbnRUeXBlXSB8fCB0aGlzLmV2ZW50TGlzdFtldmVudFR5cGVdLmxlbmd0aCA9PT0gMClcbiAgICAgIHJldHVybjtcblxuICAgIHRoaXMuZXZlbnRMaXN0W2V2ZW50VHlwZV0uZm9yRWFjaCgoZXZlbnRDYWxsYmFjaykgPT4ge1xuICAgICAgZXZlbnRDYWxsYmFjayhldmVudCk7XG4gICAgfSk7XG4gIH1cblxuICBfcmVnaXN0ZXJMaXN0ZW5lcigpIHtcbiAgICB3YXRjaF9ncGlvKFxuICAgICAgdGhpcy5waW5zLkNMSyxcbiAgICAgIEdQSU9fTU9ERV9JTlBVVF9QVUxMVVAsXG4gICAgICA0MDAsXG4gICAgICBHUElPX0VER0VfQk9USCxcbiAgICAgIChzdGF0ZTogbnVtYmVyKSA9PiB7XG4gICAgICAgIGlmIChzdGF0ZSA9PT0gMSkge1xuICAgICAgICAgIGNvbnN0IGR0VmFsdWUgPSBnZXRfZ3Bpbyh0aGlzLnBpbnMuRFQpO1xuICAgICAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IGR0VmFsdWUgPyBcImxlZnRcIiA6IFwicmlnaHRcIjtcbiAgICAgICAgICB0aGlzLl90cmlnZ2VyRXZlbnQoXCJ0dXJuXCIsIHsgZGlyZWN0aW9uIH0pO1xuICAgICAgICAgIHRoaXMuX3RyaWdnZXJFdmVudChkaXJlY3Rpb24gPT09IFwibGVmdFwiID8gXCJ0dXJuTGVmdFwiIDogXCJ0dXJuUmlnaHRcIik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApO1xuXG4gICAgdGhpcy5idXR0b24ub25QcmVzcygoKSA9PiB7XG4gICAgICB0aGlzLl90cmlnZ2VyRXZlbnQoXCJwcmVzc1wiKTtcbiAgICB9KTtcblxuICAgIHRoaXMuYnV0dG9uLm9uU2hvcnRQcmVzcygoKSA9PiB7XG4gICAgICB0aGlzLl90cmlnZ2VyRXZlbnQoXCJzaG9ydFByZXNzXCIpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5idXR0b24ub25Mb25nUHJlc3MoKCkgPT4ge1xuICAgICAgdGhpcy5fdHJpZ2dlckV2ZW50KFwibG9uZ1ByZXNzXCIpO1xuICAgIH0pO1xuICB9XG5cbiAgb25UdXJuKGNhbGxiYWNrOiBSb3RhcnlFdmVudENhbGxiYWNrKSB7XG4gICAgdGhpcy5fYXBwZW5kRXZlbnQoXCJ0dXJuXCIsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIG9uVHVybkxlZnQoY2FsbGJhY2s6IFJvdGFyeUV2ZW50Q2FsbGJhY2spIHtcbiAgICB0aGlzLl9hcHBlbmRFdmVudChcInR1cm5MZWZ0XCIsIGNhbGxiYWNrKTtcbiAgfVxuICBvblR1cm5SaWdodChjYWxsYmFjazogUm90YXJ5RXZlbnRDYWxsYmFjaykge1xuICAgIHRoaXMuX2FwcGVuZEV2ZW50KFwidHVyblJpZ2h0XCIsIGNhbGxiYWNrKTtcbiAgfVxuICBvblByZXNzKGNhbGxiYWNrOiBSb3RhcnlFdmVudENhbGxiYWNrKSB7XG4gICAgdGhpcy5fYXBwZW5kRXZlbnQoXCJwcmVzc1wiLCBjYWxsYmFjayk7XG4gIH1cbiAgb25TaG9ydFByZXNzKGNhbGxiYWNrOiBSb3RhcnlFdmVudENhbGxiYWNrKSB7XG4gICAgdGhpcy5fYXBwZW5kRXZlbnQoXCJzaG9ydFByZXNzXCIsIGNhbGxiYWNrKTtcbiAgfVxuICBvbkxvbmdQcmVzcyhjYWxsYmFjazogUm90YXJ5RXZlbnRDYWxsYmFjaykge1xuICAgIHRoaXMuX2FwcGVuZEV2ZW50KFwibG9uZ1ByZXNzXCIsIGNhbGxiYWNrKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgTm9kZUhlbHBlck1vZHVsZSB9IGZyb20gXCJub2RlX2hlbHBlclwiO1xuaW1wb3J0IHsgUm90YXJ5LCBSb3RhcnlQaW5zIH0gZnJvbSBcIi4vZ3Bpby9Sb3RhcnlcIjtcblxuY2xhc3MgUm90YXJ5Tm9kZUhlbHBlciB7XG4gIHJvdGFyeTogUm90YXJ5IHwgbnVsbCA9IG51bGw7XG4gIG5vZGVIZWxwZXI6IE5vZGVIZWxwZXJNb2R1bGU7XG4gIHJvdGFyeVBpbnM6IFJvdGFyeVBpbnM7XG4gIGNvbnN0cnVjdG9yKG5vZGVIZWxwZXI6IE5vZGVIZWxwZXJNb2R1bGUsIHJvdGFyeVBpbnM6IFJvdGFyeVBpbnMpIHtcbiAgICB0aGlzLm5vZGVIZWxwZXIgPSBub2RlSGVscGVyO1xuICAgIHRoaXMucm90YXJ5UGlucyA9IHJvdGFyeVBpbnM7XG4gIH1cblxuICBzb2NrZXROb3RpZmljYXRpb25SZWNlaXZlZChub3RpZmljYXRpb246IHN0cmluZykge1xuICAgIGlmIChub3RpZmljYXRpb24gPT09IFwiUk9UQVJZX0lOSVRcIikgdGhpcy5faW5pdCgpO1xuICB9XG5cbiAgX2luaXQoKSB7XG4gICAgaWYgKHRoaXMucm90YXJ5KSByZXR1cm47XG5cbiAgICB0aGlzLnJvdGFyeSA9IG5ldyBSb3RhcnkodGhpcy5yb3RhcnlQaW5zKTtcblxuICAgIHRoaXMucm90YXJ5Lm9uVHVybkxlZnQoKCkgPT4ge1xuICAgICAgdGhpcy5ub2RlSGVscGVyLnNlbmRTb2NrZXROb3RpZmljYXRpb24oXCJST1RBUllfUFJFVlwiLCBudWxsKTtcbiAgICB9KTtcblxuICAgIHRoaXMucm90YXJ5Lm9uVHVyblJpZ2h0KCgpID0+IHtcbiAgICAgIHRoaXMubm9kZUhlbHBlci5zZW5kU29ja2V0Tm90aWZpY2F0aW9uKFwiUk9UQVJZX05FWFRcIiwgbnVsbCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnJvdGFyeS5vblByZXNzKCgpID0+IHtcbiAgICAgIHRoaXMubm9kZUhlbHBlci5zZW5kU29ja2V0Tm90aWZpY2F0aW9uKFwiUk9UQVJZX1BSRVNTXCIsIG51bGwpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5yb3Rhcnkub25TaG9ydFByZXNzKCgpID0+IHtcbiAgICAgIHRoaXMubm9kZUhlbHBlci5zZW5kU29ja2V0Tm90aWZpY2F0aW9uKFwiUk9UQVJZX1NIT1JUX1BSRVNTXCIsIG51bGwpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5yb3Rhcnkub25Mb25nUHJlc3MoKCkgPT4ge1xuICAgICAgdGhpcy5ub2RlSGVscGVyLnNlbmRTb2NrZXROb3RpZmljYXRpb24oXCJST1RBUllfTE9OR19QUkVTU1wiLCBudWxsKTtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBSb3RhcnlOb2RlSGVscGVyO1xuIiwiaW1wb3J0ICogYXMgTm9kZUhlbHBlciBmcm9tIFwibm9kZV9oZWxwZXJcIjtcbmltcG9ydCBSb3RhcnlOb2RlSGVscGVyIGZyb20gXCIuL1JvdGFyeU5vZGVIZWxwZXJcIjtcbmltcG9ydCAqIGFzIEdQSU9YIGZyb20gXCJAaWlvdDJrL2dwaW94XCI7XG5cbmV4cG9ydCBkZWZhdWx0IE5vZGVIZWxwZXIuY3JlYXRlKHtcbiAgcm90YXJ5SGVscGVyOiBSb3RhcnlOb2RlSGVscGVyLFxuXG4gIHN0YXJ0KCkge1xuICAgIGNvbnNvbGUubG9nKFwiTm9kZUhlbHBlciBzdGFydGVkIFJvdGFyeSBTdGFydGVkXCIpO1xuXG4gICAgdGhpcy5yb3RhcnlIZWxwZXIgPSBuZXcgUm90YXJ5Tm9kZUhlbHBlcih0aGlzLCB7XG4gICAgICBTVzogMjcsXG4gICAgICBDTEs6IDE3LFxuICAgICAgRFQ6IDE4XG4gICAgfSk7XG4gIH0sXG5cbiAgYXN5bmMgc29ja2V0Tm90aWZpY2F0aW9uUmVjZWl2ZWQobm90aWZpY2F0aW9uLCBwYXlsb2FkKSB7XG4gICAgY29uc29sZS5sb2coXCJSb3Rhcnkgc3RhcnQgbm90aWZpY2F0aW9uIHJlY2l2ZWRcIiwgbm90aWZpY2F0aW9uKTtcbiAgICB0aGlzLnJvdGFyeUhlbHBlci5zb2NrZXROb3RpZmljYXRpb25SZWNlaXZlZChub3RpZmljYXRpb24pO1xuICB9XG59KTtcbiJdLCJuYW1lcyI6WyJkZWluaXRfZ3BpbyIsIndhdGNoX2dwaW8iLCJHUElPX01PREVfSU5QVVRfUFVMTFVQIiwiR1BJT19FREdFX0JPVEgiLCJpbml0X2dwaW8iLCJnZXRfZ3BpbyIsIk5vZGVIZWxwZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztNQVVhLE1BQU0sQ0FBQTtBQU9qQixJQUFBLFdBQUEsQ0FBWSxHQUFXLEVBQUE7UUFMdkIsSUFBUyxDQUFBLFNBQUEsR0FBd0QsRUFBRTtBQUNuRSxRQUFBLElBQUEsQ0FBQSxLQUFLLEdBQUc7QUFDTixZQUFBLE1BQU0sRUFBRSxLQUFLO0FBQ2IsWUFBQSxVQUFVLEVBQUU7U0FDYjtBQUVDLFFBQUEsSUFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHO1FBRWQsSUFBSSxDQUFDLGlCQUFpQixFQUFFOztJQUcxQixPQUFPLEdBQUE7QUFDTCxRQUFBQSxpQkFBVyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7O0lBR3ZCLFlBQVksQ0FBQyxTQUFzQixFQUFFLFFBQTZCLEVBQUE7QUFDaEUsUUFBQSxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRTtRQUUzRCxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENB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
